#!/bin/bash

echo "üßπ –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã..."

# –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –ø–∞—Ä—Å–µ—Ä–∞
echo "üõë –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –ø–∞—Ä—Å–µ—Ä–∞..."
pkill -f "image-parser" 2>/dev/null || true

# –û—á–∏—â–∞–µ–º –ª–æ–≥–∏
echo "üóëÔ∏è –û—á–∏—â–∞—é —Å—Ç–∞—Ä—ã–µ –ª–æ–≥–∏..."
rm -f parser.log parser.2025-08-19.log
rm -f logs/*.log 2>/dev/null || true

# –û—á–∏—â–∞–µ–º –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –æ—Ç –ø—É—Å—Ç—ã—Ö –∑–∞–ø–∏—Å–µ–π
echo "üóëÔ∏è –û—á–∏—â–∞—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö..."
sqlite3 parser_data.db "DELETE FROM link_results WHERE status = 'empty';" 2>/dev/null || true
sqlite3 parser_data.db "VACUUM;" 2>/dev/null || true

# –û—á–∏—â–∞–µ–º –ø–∞–ø–∫—É –∑–∞–≥—Ä—É–∑–æ–∫
echo "üóëÔ∏è –û—á–∏—â–∞—é –ø–∞–ø–∫—É –∑–∞–≥—Ä—É–∑–æ–∫..."
rm -rf downloads/* 2>/dev/null || true

# –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
echo "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏:"
echo "–†–∞–∑–º–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:"
ls -lh parser_data.db 2>/dev/null || echo "–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"

echo "–†–∞–∑–º–µ—Ä –ø–∞–ø–∫–∏ downloads:"
du -sh downloads 2>/dev/null || echo "–ü–∞–ø–∫–∞ downloads –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"

echo "–†–∞–∑–º–µ—Ä –ø–∞–ø–∫–∏ logs:"
du -sh logs 2>/dev/null || echo "–ü–∞–ø–∫–∞ logs –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"

echo "‚úÖ –û—á–∏—Å—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"
